2022-09-2921:32
Tags: #Java #JavaCoreAdvanced #StreamAPI 

__
# Создание потоков данных из файлов
API NIO(non-blocking I/O) языка Java, был расширен для того, чтобы использовать возможности StreamAPI. Многие статистические методы из пакета java.nio.file.Files возвращают поток данных. 

Например, удобный метод Files.lines возвращает поток строк файла в виде символьных значений. С помощью полученных ранее знаний мы можем применить этот метод для вычисления количество уникальных слов в файле
```java
long uniqueWorld = 0;
try(Stream<String> lines = 
   Files.lines(Paths.get("data.txt"), Charset.defaultCharset())){
   //интерфейч Stream<T> реализует интерфейс AutoCloseable, так что необходимости
   //в блоке try-finally необходимости нет
   uniqueWords = lines.flatMap(line -> Arrays.stream(line.split(" "))) //поток слов
	   .distinct()//удаляем дубликаты
	   .count();//подсчитываем количество слов
   }
catch(IOException e){
//Обрабатываем исключения, которые могут возникнуть при открытии файла
}
```
Метод Files.lines используется, чтобы вернуть поток, каждый элемент которого представляет собой одну из строк заданного файла. Этот вызов заключен в блок try/catch, поскольку источник потока данных - ресурс ввода/вывода, который необходимо поток закрыть во избежание утечек памяти. Ранее для этой цели требовался явный блок finally, но теперь интерфейс Stream реализует интерфейс AutoCloseable. Это значит, что управление ресурсом происходит автоматически внутри блока try. После получения потока строк файла можно разбить каждую из них на отдельные слова с помощью вызова метода split объектов line. Стоит обратить внимаение на использование операции flatMap для генерации одного схлопнутого потока слов вместо множества потоков слов для каждой из строк файла. И наконец, мы считаем число уникальных слов в потоке, связывая цепочкой методы distinct и count. 

__
### Zero-Links
- [[Создание потоков данных]]

__
### Links
- 

