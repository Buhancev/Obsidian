2023-02-1418:51
Tags: #Java #SpringFramework #SpringBoot #SpringIntegraton

__
# Объявление простого потока интеграции

Spring Integration позволяет создавать потоки интеграции, через которые приложение может получать или отправлять данные в какой-нибудь ресурс, внешний по отношению к приложению. Один из таких ресурсов - файловая система. В SI есть адаптеры канало для чтения и записи файлов.

Чтобы подключить SI нужно добавить зависимость:
![[Pasted image 20230214185925.png]]

Так как мы хотим создать поток для I/O в файловую систему, то также необходима зависимость:
![[Pasted image 20230214185953.png]]

У Spring Integration имеет более 20 конечных точек для работы с внешними системами.

Реализуем возможность отправлять данные в поток интеграции, чтобы их можно было записать файл:
```java
@MessagingGateway(defaultRequestChannel="textInChannel")
public interface FileWriterGateWay {
	void writeToFile(
		@Header(FileHeaders.FILENAME) String filename, String data);
}
```
**FileWriterGateWay** - обычный интерфейс Жаба, но о нем много можно рассказать. 

Прежде всего стоит обратить внимание на **@MessagingGateway**. Она требует от фреймворка Spring Integration создать реализацию этого интерфейса во время выполнения, подому тока, как Spring Data автоматически генерирует реализации интерфейсов репозиториев. Эта реализация будет использоваться другими частями кода, когда им потребуется выполнить запись в файл.

Атрибут **defaultRequestChannel** аннтоации @MessagingGateway определяет канал, куда должны отправляться любые сообщения, возникающие в рез-те вызова методов интерфейса. В данном случае все сообщения, возникающие в рез-те вызова **writeToFile()**, будут направляться в канал с **textInChannel**. 

Метод *writeToFile* имеет параметр *filename*, который снабжен аннотацией **@Header**. Она сообщает, что значение *filename* должно быть помещано в заголовок сообщения определяемый константой FileHeaders.FILENAME в классе FileHeaders, которая имеет значение   
"file_name", а не в тело сообщения. С другой стороны, параметр **data** передается в теле сообщения.

После создания шлюза надо настроить поток интеграции. Хоть мы и добавили зависимость в сборку, мы всё равно должны определить доп. настройки для потоков, отвечающих потребностям приложения.

Поддерживаются три варианта конфигураций для объявления потоков интеграций:
- конфигурация XML
- конфигурация Java
- конфигурация Java с DSL

__
### Zero-Links
- [[Spring Integration]]

__
### Links
- [[Определение потоков Spring Integration в XML]]
- [[Определение потоков Spring Integration в коде на Java]]
- [[Определение потоков Spring Integration DSL]]

